<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Trobe GPA Calculator (7.0 Scale)</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #f8f9fa; display: flex; justify-content: center; padding: 40px 20px; color: #333; }
        .container { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); width: 100%; max-width: 650px; }
        h2 { color: #d71920; text-align: center; margin-bottom: 5px; }
        p.subtitle { text-align: center; font-size: 0.9em; color: #666; margin-bottom: 25px; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th { background-color: #f2f2f2; padding: 12px; font-weight: 600; border-bottom: 2px solid #dee2e6; }
        td { padding: 12px; border-bottom: 1px solid #eee; text-align: center; }
        input { padding: 8px; width: 85%; border: 1px solid #ced4da; border-radius: 4px; transition: border-color 0.2s; }
        input:focus { outline: none; border-color: #d71920; }
        
        /* 按钮组样式 */
        .btn-group { margin-bottom: 15px; display: flex; gap: 10px; }
        .btn-add { background-color: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 500; }
        .btn-add:hover { background-color: #218838; }
        .btn-clear { background-color: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 500; }
        .btn-clear:hover { background-color: #5a6268; }
        
        .btn-calc { background-color: #d71920; color: white; border: none; padding: 14px; width: 100%; border-radius: 6px; font-size: 16px; cursor: pointer; font-weight: bold; text-transform: uppercase; }
        .btn-calc:hover { background-color: #b5151a; }
        
        #result { margin-top: 25px; padding: 20px; background: #f1f3f5; border-radius: 8px; text-align: center; font-size: 1.25em; display: none; border-left: 5px solid #d71920; }
        .footer-note { font-size: 12.5px; color: #777; margin-top: 20px; line-height: 1.5; border-top: 1px solid #eee; padding-top: 15px; }
        .delete-btn { color: #dc3545; border: none; background: none; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h2>GPA Calculator</h2>
    <p class="subtitle">Based on La Trobe University Official 7.0 Grading Scale</p>
    
    <table id="courseTable">
        <thead>
            <tr>
                <th>Credit Points (CP)</th>
                <th>Mark (%) or Grade</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><input type="number" class="cp" value="15" step="15" min="0"></td>
                <td><input type="text" class="score" placeholder="e.g., 85, A, or P"></td>
                <td><button class="delete-btn" onclick="removeRow(this)">Remove</button></td>
            </tr>
        </tbody>
    </table>

    <div class="btn-group">
        <button class="btn-add" onclick="addRow()">+ Add Subject</button>
        <button class="btn-clear" onclick="clearAll()">Clear All</button>
    </div>

    <button class="btn-calc" onclick="calculateGPA()">Calculate GPA</button>

    <div id="result"></div>
    
    <div class="footer-note">
        <strong>Grading Reference:</strong><br>
        • A (80-100%): 7.0 | B (70-79%): 6.0 | C (60-69%): 5.0 | D (50-59%): 4.0 | N (0-49%): 0.0 <br>
        • <strong>Ungraded Pass (P) / Ungraded Fail (F):</strong> Excluded from GPA calculation.
    </div>
</div>

<script>
    function addRow() {
        const tbody = document.querySelector("#courseTable tbody");
        const row = document.createElement("tr");
        row.innerHTML = `
            <td><input type="number" class="cp" value="15" step="15" min="0"></td>
            <td><input type="text" class="score" placeholder="e.g., 85 or A"></td>
            <td><button class="delete-btn" onclick="removeRow(this)">Remove</button></td>
        `;
        tbody.appendChild(row);
    }

    function removeRow(btn) {
        const rows = document.querySelectorAll("#courseTable tbody tr");
        if (rows.length > 1) {
            btn.closest("tr").remove();
        } else {
            alert("At least one subject is required.");
        }
    }

    function clearAll() {
        const tbody = document.querySelector("#courseTable tbody");
        tbody.innerHTML = `
            <tr>
                <td><input type="number" class="cp" value="15" step="15" min="0"></td>
                <td><input type="text" class="score" placeholder="e.g., 85, A, or P"></td>
                <td><button class="delete-btn" onclick="removeRow(this)">Remove</button></td>
            </tr>
        `;
        document.getElementById("result").style.display = "none";
        document.getElementById("result").innerHTML = "";
    }

    function getPoints(val) {
        val = val.toUpperCase().trim();
        
        if (val === 'P' || val === 'UNGRADED PASS' || val === 'F' || val === 'UNGRADED FAIL' || val === 'V') {
            return 'SKIP';
        }

        if (!isNaN(val) && val !== "") {
            const num = parseFloat(val);
            if (num >= 80) return 7.0;
            if (num >= 70) return 6.0;
            if (num >= 60) return 5.0;
            if (num >= 50) return 4.0;
            if (num >= 0) return 0.0;
        }

        if (val === 'A' || val === 'HD') return 7.0;
        if (val === 'B' || val === 'D') return 6.0;
        if (val === 'C') return 5.0;
        if (val === 'D') return 4.0; 
        if (val === 'N') return 0.0;
        
        return null;
    }

    function calculateGPA() {
        const rows = document.querySelectorAll("#courseTable tbody tr");
        let totalWeightedPoints = 0;
        let totalCP = 0;

        rows.forEach(row => {
            const cpValue = row.querySelector(".cp").value;
            const scoreVal = row.querySelector(".score").value;
            
            const cp = parseFloat(cpValue);
            const points = getPoints(scoreVal);

            if (points !== 'SKIP' && points !== null && !isNaN(cp)) {
                totalWeightedPoints += (points * cp);
                totalCP += cp;
            }
        });

        const resultDiv = document.getElementById("result");
        resultDiv.style.display = "block";

        if (totalCP === 0) {
            resultDiv.innerHTML = "<strong>No valid data for calculation.</strong><br><small>Note: Ungraded results (P/F/V) are excluded.</small>";
        } else {
            const gpa = (totalWeightedPoints / totalCP).toFixed(3);
            resultDiv.innerHTML = `Your Current GPA: <strong>${gpa} / 7.0</strong><br>
                                   <span style="font-size: 0.7em; color: #666;">Total Credits Counted: ${totalCP} CP</span>`;
        }
    }
</script>

</body>
</html>
